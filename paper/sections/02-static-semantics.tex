% \section{Static Semantics}
% We define an interpretation function $interp(b)$ evaluating bounds to points in
% $\textit{num}$. 
%
% \begin{equation}
%   \begin{aligned}[c]
%     interp(k \in \textit{num}) &\triangleq k \\
%     interp(b_0 + b_1) &\triangleq interp(b_0) + interp(b_1) \\
%     interp(b_0 \cdot b_1) &\triangleq interp(b_0) \cdot interp(b_1) \\
%   \end{aligned}
% \end{equation}

\begin{figure}
%% ROW1
\begin{center}
%% unit
\AXC{}
\RightLabel{(Unit)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash \langle \rangle : \mathbf{unit}$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% var
\AXC{$s \ge 1$}
\RightLabel{(Var)}
  \UIC{$\bnd{\Delta \ |} \ \Gamma, x:_s \tau, \Theta \vdash x : \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% fun
\AXC{$\bnd{\Delta \ |} \ \Gamma, x:_1 \tau_0 \vdash e : \tau$}
\RightLabel{($\multimap$ I)}
\UnaryInfC{$\bnd{\Delta \ |} \ \Gamma \vdash \lambda x. e : \tau_0 \multimap \tau $}
\bottomAlignProof
\DisplayProof
\vskip 1em

%% app
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_0 \multimap \tau$}
\AXC{$\bnd{\Delta \ |} \ \Theta \vdash f : \tau_0 $}
\RightLabel{($\multimap$ E)}
\BinaryInfC{$\bnd{\Delta \ |} \ \Gamma + \Theta \vdash ef : \tau $}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% dep prod intro
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_0$}
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash f : \tau_1$}
\RightLabel{($\times$ I)}
\BinaryInfC{$\bnd{\Delta \ |} \ \Gamma \vdash \langle e, f \rangle: \tau_0 \times \tau_1$}
\bottomAlignProof
\DisplayProof
\vskip 1em
%%


%% ROW2
%% dep prod elim
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_1 \times \tau_2$}
\RightLabel{($\times$ E)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash {\pi}_i \ e : \tau_i$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% ind prod intro
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_0 $}
\AXC{$\bnd{\Delta \ |} \ \Theta \vdash f : \tau_1$}
\RightLabel{($\tensor$ I)}
\BIC{$\bnd{\Delta \ |} \ \Gamma + \Theta \vdash (e, f) : \tau_0 \tensor \tau_1$}
\bottomAlignProof
\DisplayProof
\vskip 1em

%% ind prod elim
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_0 \tensor \tau_1$ }
\AXC{$\bnd{\Delta \ |} \ \Theta,x:_s \tau_0,y:_s\tau_1 \vdash f: \tau $}
\RightLabel{($\tensor$ E)}
\BIC{$\bnd{\Delta \ |} \ s * \Gamma + \Theta \vdash \letpair (x,y) \ = \ e \ \tin \ f : \tau $}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% ind sum intro
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_0$ }
\RightLabel{($+$ $\text{I}_i$)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash \mathbf{in}_i \ e : \tau_0 + \tau_1$}
\bottomAlignProof
\DisplayProof
\vskip 1em

% sum elim
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau_0+\tau_1$}
\AXC{$\bnd{\Delta \ |} \ \Theta, x:_s \tau_0 \vdash f_1 : \tau$ \qquad
$\Delta \ | \ \Theta, x:_s \tau_1 \vdash f_2: \tau$}
\RightLabel{($+$ E)}
\AXC{$s > 0$}
\TIC{$\bnd{\Delta \ |} \ s * \Gamma + \Theta \vdash \mathbf{case} \ e \ \mathbf{of} \ (\mathbf{in}_1 x.f_1 \ | \ \mathbf{in}_2 x.f_2) : \tau$}
\bottomAlignProof
\DisplayProof
\vskip 1em

% box elim
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : {!_s \tau_0}$}
\AXC{$\bnd{\Delta \ |} \ \Theta, x:_{t*s} \tau_0 \vdash f : \tau$}
\RightLabel{($!$ E)}
\BIC{$\bnd{\Delta \ |} \ t * \Gamma + \Theta \vdash \letcobind x = e \ \tin \ f : \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
% ops
% \AXC{$\Delta \ | \ \Gamma \vdash e : \tau_0$}
\AXC{$\{ \mathbf{op} :\tau \} \in \Sigma$}
\RightLabel{(Op)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash \mathbf{op} : \tau$}
\bottomAlignProof
\DisplayProof
\vskip 1em
%%


%% ROW 5

%%% ROW 6

% let 
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e :  \tau_0$}
\AXC{$\bnd{\Delta \ |} \ \Theta, x:_{s} \tau \vdash f : \tau$}
\RightLabel{(Let)}
\BIC{$\bnd{\Delta \ |} \ s * \Gamma + \Theta \vdash \letassign x = e \ \tin \ f : \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% const
\AXC{$k, k_0, k_1 \in \textit{num}$}
\AXC{$k_0 \leq k \leq k_1$}
\RightLabel{(Const)}
\BIC{$\bnd{\Delta \ |} \ \Gamma \vdash k : \num_{\bnd{(k_0, k_1)}}$}
\bottomAlignProof
\DisplayProof
\vskip 1em

%% widen
\AXC{$(k_0, k_1) \sqsubseteq (k'_0, k'_1)$}
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \num_{\bnd{(k_0, k_1)}}$}
\RightLabel{(Widen)}
\BIC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \num_{\bnd{(k'_0, k'_1)}}$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
% box intro
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau$ }
\RightLabel{($!$ I)}
\UIC{$\bnd{\Delta \ |} \ s * \Gamma \vdash [e] : {!_s \tau}$}
\bottomAlignProof
\DisplayProof
\vskip 1em

%%% ROW 7

%% subsumption
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e :  M_q \tau$}
\AXC{$r \ge q$}
\RightLabel{(Subsumption)}
\BIC{$\bnd{\Delta \ |} \ \Gamma \vdash e :  M_{r} \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
% factor
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : (M_q \tau_0) \times (M_r \tau_1)$}
\RightLabel{(Factor)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash \factor \ e : M_{max(q,r)} (\tau_0 \times \tau_1)$}
\bottomAlignProof
\DisplayProof
\vskip 1em
%% return
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \tau$}
\RightLabel{(Ret)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash \ret e : M_0 \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% RND
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : \num_{\bnd{i}}$}
\RightLabel{(Rnd)}
\UIC{$\bnd{\Delta \ |} \ \Gamma \vdash \rnd \ e : M_u \ \num_{\bnd{i}}$}
\bottomAlignProof
\DisplayProof
\vskip 1em


%%% ROW 8


% let-bind
\AXC{$\bnd{\Delta \ |} \ \Gamma \vdash e : M_r \tau_0$}
\AXC{$\bnd{\Delta \ |} \ \Theta, x:_{s} \tau_0 \vdash f : M_{q} \tau$}
\RightLabel{($M_u$ E)}
\BIC{$\bnd{\Delta \ |} \ s * \Gamma + \Theta \vdash \letbind x = e \ \tin \ f : M_{s*r+q} \tau$}
\bottomAlignProof
\DisplayProof
\vskip 1em

% bvar
\AXC{}
\RightLabel{($\bnd{\textbf{bvar}}$)}
\UIC{$\Delta, \epsilon : \textbf{bnd} \vdash \epsilon : \textbf{bnd}$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
\AXC{$\Delta \vdash b_0 : \textbf{bnd}$}
\AXC{$\ldots$}
\AXC{$\Delta \vdash b_c : \textbf{bnd}$}
\AXC{$\textbf{iop}_c \in \Sigma_{\textbf{bnd}}$}
\RightLabel{(\bnd{$\textbf{b}$\textbf{op}})}
\QIC{$\Delta \vdash \textbf{iop}_c(i_0, \ldots, i_c) : \textbf{bnd}$}
\bottomAlignProof
\DisplayProof
\vskip 1em

\AXC{$\Delta, \epsilon : \textbf{bnd} \ | \ \Gamma \vdash e : \tau$}
\AXC{$\epsilon \not\in FTV(\Gamma)$}
\RightLabel{(\bnd{$\forall$-I})}
\BIC{$\Delta \ | \ \Gamma \vdash \Lambda \epsilon . e : \forall \epsilon . \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
\AXC{$\Delta \ | \ \Gamma \vdash e : \forall \epsilon . \tau$}
\AXC{$\Delta \vdash i : \textbf{bnd}$}
\RightLabel{(\bnd{$\forall$-E})}
\BIC{$\Delta \ | \ \Gamma \vdash e~\{i\} : \tau[i/\epsilon]$}
\bottomAlignProof
\DisplayProof

\vskip 3em

\end{center}
    \caption{Typing rules for \Lang, with $s,t,q,r,u \in \NNR \cup \{\infty\}$
    and for $i \in \{ 1, 2 \}$ where $u$ is a fixed constant parameter (see
    Definition~\ref{def:numfuzz-interface} for details on picking an adequate
    constant). $FTV(\Gamma)$ refers to all the free type variables (e.g.
    $\epsilon_0, \epsilon_1$) in $\Gamma$.}
    \label{fig:typing_rules}
\end{figure}


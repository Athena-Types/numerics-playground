\section{Static Semantics}

\begin{figure}
%% ROW1
\begin{center}
%% var
\AXC{$s \ge 1$}
\RightLabel{(Var)}
\UIC{$\Gamma, x:_s \sigma, \Delta \vdash x : \sigma$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% fun
\AXC{$\Gamma, x:_1 \sigma \vdash e : \tau$}
\RightLabel{($\multimap$ I)}
\UnaryInfC{$\Gamma \vdash \lambda x. e : \sigma \multimap \tau $}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% app
\AXC{$\Gamma \vdash v : \sigma \multimap \tau$}
\AXC{$\Theta \vdash w : \sigma $}
\RightLabel{($\multimap$ E)}
\BinaryInfC{$\Gamma + \Theta \vdash vw : \tau $}
\bottomAlignProof
\DisplayProof
\vskip 1em
%%


%% ROW2
\AXC{}
\RightLabel{(Unit)}
\UIC{$\Gamma \vdash \langle \rangle : \mathbf{unit}$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% dep prod intro
\AXC{$\Gamma \vdash v : \sigma$}
\AXC{$\Gamma \vdash w : \tau$}
\RightLabel{($\times$ I)}
\BinaryInfC{$\Gamma \vdash \langle v, w \rangle: \sigma \times \tau $}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% dep prod elim
\AXC{$\Gamma \vdash v : \tau_1 \times \tau_2$}
\RightLabel{($\times$ E)}
\UIC{$\Gamma \vdash {\pi}_i \ v : \tau_i$}
\bottomAlignProof
\DisplayProof
\vskip 1em
%%

%% ind prod intro
\AXC{$\Gamma \vdash v : \sigma $}
\AXC{$\Theta \vdash w : \tau$}
\RightLabel{($\tensor$ I)}
\BIC{$\Gamma + \Theta \vdash (v, w) : \sigma \tensor \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% ind prod elim
\AXC{$\Gamma \vdash v : \sigma \tensor \tau$ }
\AXC{$\Theta,x:_s \sigma,y:_s\tau \vdash e: \rho $}
\RightLabel{($\tensor$ E)}
\BIC{$s * \Gamma + \Theta \vdash \letdestruct (x,y) \ = \ v \ \tin \ e : \rho $}
\bottomAlignProof
\DisplayProof
\vskip 1em
%%


%% ROW 4

%% ind sum intro
\AXC{$\Gamma \vdash v : \sigma$ }
\RightLabel{($+$ $\text{I}_1$)}
\UIC{$\Gamma \vdash \mathbf{in}_1 \ v : \sigma + \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% ind sum intro
\AXC{$\Gamma \vdash v : \tau$ }
\RightLabel{($+$ $\text{I}_2$)}
\UIC{$\Gamma \vdash \mathbf{in}_2 \ v : \sigma + \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
% box elim
\AXC{$\Gamma \vdash v : {!_s \sigma}$}
\AXC{$\Theta, x:_{t*s} \sigma \vdash e : \tau$}
\RightLabel{($!$ E)}
\BIC{$t * \Gamma + \Theta \vdash \letcobind x = v \ \tin \ e : \tau$}
\bottomAlignProof
\DisplayProof
\vskip 1em
%%


%% ROW 5

% sum elim
\AXC{$\Gamma \vdash v : \sigma+\tau$}
\AXC{$\Theta, x:_s \sigma \vdash e : \rho$ \qquad
$\Theta, x:_s \tau \vdash f: \rho$}
\RightLabel{($+$ E)}
\BIC{$s * \Gamma + \Theta \vdash \mathbf{case} \ v \ \mathbf{of} \ (\mathbf{in}_1 x.e \ | \ \mathbf{in}_2 x.f) : \rho$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
% box intro
\AXC{$\Gamma \vdash v : \sigma$ }
\RightLabel{($!$ I)}
\UIC{$s * \Gamma \vdash [v] : {!_s \sigma}$}
\bottomAlignProof
\DisplayProof
\vskip 1em

%%% ROW 6

% let 
\AXC{$\Gamma \vdash e :  \tau$}
\AXC{$\Theta, x:_{s} \tau \vdash f : \sigma$}
\RightLabel{(Let)}
\BIC{$s * \Gamma + \Theta \vdash \letassign x = e \ \tin f : \sigma$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% const
\AXC{$k \in R$}
\RightLabel{(Const)}
\UIC{$\Gamma \vdash k : \num$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
\vskip 1em

%%% ROW 7

%% subsumption
\AXC{$\Gamma \vdash e :  M_q \tau$}
\AXC{$r \ge q$}
\RightLabel{(Subsumption)}
\BIC{$\Gamma \vdash e :  M_{r} \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% return
\AXC{$\Gamma \vdash v : \tau$}
\RightLabel{(Ret)}
\UIC{$\Gamma \vdash \ret v : M_0 \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
%% RND
\AXC{$\Gamma \vdash v : \num$}
\RightLabel{(Rnd)}
\UIC{$\Gamma \vdash \rnd \ v : M_q \num$}
\bottomAlignProof
\DisplayProof
\vskip 1em


%%% ROW 8


% let-bind
\AXC{$\Gamma \vdash v : M_r \sigma$}
\AXC{$\Theta, x:_{s} \sigma \vdash f : M_{q} \tau$}
\RightLabel{($M_u$ E)}
\BIC{$s * \Gamma + \Theta \vdash \letbind x = v \ \tin \ f : M_{s*r+q} \tau$}
\bottomAlignProof
\DisplayProof
\hskip 0.5em
% funs
\AXC{$\Gamma \vdash v : \sigma$}
\AXC{$\{ \mathbf{op} :\sigma \lin \num \} \in {\Sigma}$}
\RightLabel{(Op)}
\BIC{$\Gamma \vdash \mathbf{op}(v) : \num$}
\bottomAlignProof
\DisplayProof

\end{center}
    \caption{Typing rules for \Lang, with $s,t,q,r \in \NNR \cup \{\infty\}$. }
    \label{fig:typing_rules}
\end{figure}

